---
- hosts: localhost
  tasks:
  # - name: Configure docker installation
  #   become: true
  #   ansible.builtin.shell: |
  #     mkdir -m 0755 -p /etc/apt/keyrings
  #     curl -fsSL https://download.docker.com/linux/debian/gpg | gpg --dearmor -o /etc/apt/keyrings/docker.gpg
  #     echo \
  #       "deb [arch="$(dpkg --print-architecture)" signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \
  #       "$(. /etc/os-release && echo "$VERSION_CODENAME")" stable" | \
  #       tee /etc/apt/sources.list.d/docker.list > /dev/null
  #     apt update

  - name: Install docker
    become: true
    ansible.builtin.apt:
      name: "{{ item }}"
    with_items:
      - docker
      - docker-compose

  - name: Ensure group "docker" exists with correct gid
    become: true
    ansible.builtin.group:
      name: docker
      state: present

  - name: Add user to docker group
    become: true
    ansible.builtin.user:
      name: "lenin"
      groups: docker
      append: true